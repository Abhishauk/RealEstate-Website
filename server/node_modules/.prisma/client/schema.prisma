generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id               String      @id @default(auto()) @map("_id") @db.ObjectId
  name             String?
  email            String      @unique
  image            String?
  bookedVisits     Json[]
  favResidenciesID String[]    @db.ObjectId
  residencies      Residency[] @relation("UserResidencies") // Updated relation
  ownedResidencies Residency[] @relation("OwnerResidencies") // No fields or references here
}

model Residency {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId
  title           String
  description     String
  price           Int
  address         String
  city            String
  country         String
  image           String
  facilities      Json
  userEmail       String
  owner           User     @relation("OwnerResidencies", fields: [userEmail], references: [email])
  userResidencies User?    @relation("UserResidencies", fields: [userEmail], references: [email]) // Added fields and references
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@unique(fields: [address, userEmail])
}
